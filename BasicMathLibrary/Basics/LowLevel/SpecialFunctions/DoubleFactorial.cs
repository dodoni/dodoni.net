/* MIT License
Copyright (c) 2011-2019 Markus Wendt (http://www.dodoni-project.net)

All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
 
Please see http://www.dodoni-project.net/ for more information concerning the Dodoni.net project. 
*/
using System;
using System.Numerics;

using Dodoni.BasicComponents;

namespace Dodoni.MathLibrary.Basics.LowLevel
{
    /// <summary>Represents the implementation of the double factorial n!! = \prod_{j=}^k (n - 2 * j), where k = <see cref="Math.Ceiling(double)"/>(n / 2) -1.
    /// </summary>
    public class DoubleFactorial
    {
        #region private members

        /// <summary>A table containing the values of n!! from 0,1,...,300; The value of 301! can not represented by a <see cref="System.Double"/>.
        /// </summary>
        /// <remarks>The values are calculated via a simple <see cref="BigInteger"/> implementation.</remarks>
        private double[] m_Values = new double[] {
                            1.0E+0,
                            1.0E+0,
                            2.0E+0,
                            3.0E+0,
                            8.0E+0,
                            1.5E+1,
                            4.8E+1,
                            1.05E+2,
                            3.84E+2,
                            9.45E+2,
                            3.840E+3,
                            1.0395E+4,
                            4.6080E+4,
                            1.35135E+5,
                            6.45120E+5,
                            2.027025E+6,
                            1.0321920E+7,
                            3.4459425E+7,
                            1.85794560E+8,
                            6.54729075E+8,
                            3.715891200E+9,
                            1.3749310575E+10,
                            8.1749606400E+10,
                            3.16234143225E+11,
                            1.961990553600E+12,
                            7.905853580625E+12,
                            5.1011754393600E+13,
                            2.13458046676875E+14,
                            1.428329123020800E+15,
                            6.190283353629375E+15,
                            4.2849873690624000E+16,
                            1.91898783962510625E+17,
                            1.371195958099968000E+18,
                            6.332659870762850625E+18,
                            4.6620662575398912000E+19,
                            2.21643095476699771875E+20,
                            1.678343852714360832000E+21,
                            8.200794532637891559375E+21,
                            6.3777066403145711616000E+22,
                            3.19830986772877770815625E+23,
                            2.551082656125828464640000E+24,
                            1.3113070457687988603440625E+25,
                            1.07145471557284795514880000E+26,
                            5.63862029680583509947946875E+26,
                            4.714400748520531002654720000E+27,
                            2.5373791335626257947657609375E+28,
                            2.16862434431944426122117120000E+29,
                            1.192568192774434123539907640625E+30,
                            1.0409396852733332453861621760000E+31,
                            5.8435841445947272053455474390625E+31,
                            5.20469842636666622693081088000000E+32,
                            2.980227913743310874726229193921875E+33,
                            2.7064431817106664380040216576000000E+34,
                            1.57952079428395476360490147277859375E+35,
                            1.461479318123759876522171695104000000E+36,
                            8.687364368561751199826958100282265625E+36,
                            8.1842841814930553085241614925824000000E+37,
                            4.95179769008019818390136611716089140625E+38,
                            4.746884825265972078944013665697792000000E+39,
                            2.9215606371473169285018060091249259296875E+40,
                            2.84813089515958324736640819941867520000000E+41,
                            1.782151988659863326386101665566204817109375E+42,
                            1.7658411549989416133671730836395786240000000E+43,
                            1.12275575285571389562324404930670903477890625E+44,
                            1.130138339199322632554990773529330319360000000E+45,
                            7.297912393562140321551086320493608726062890625E+45,
                            7.4589130387155293748629391052935801077760000000E+46,
                            4.88960130368663401543922783473071784646213671875E+47,
                            5.072060866326559974906798591599634473287680000000E+48,
                            3.3738248995437774706530672059641953140588743359375E+49,
                            3.55044260642859198243475901411974413130137600000000E+50,
                            2.395415678676082004163677716234578672981800778515625E+51,
                            2.5563186766285862273530264901662157745369907200000000E+52,
                            1.74865344543353986303948473285124243127671456831640625E+53,
                            1.891675820705153808241239602722999673157373132800000000E+54,
                            1.3114900840751548972796135496384318234575359262373046875E+55,
                            1.43767362373591689426334209806947975159960358092800000000E+56,
                            1.009847364737869270905302433221592504062302663202724609375E+57,
                            1.1213854265140151775254068364941942062476907931238400000000E+58,
                            7.9777941814291672401518892224505807820921910393015244140625E+58,
                            8.97108341211212142020325469195355364998152634499072000000000E+59,
                            6.462013286957625464523030270184970433494674741834234775390625E+60,
                            7.3562883979319395645666688474019139929848516028923904000000000E+61,
                            5.36347102817482913555411512425352545980058003572241486357421875E+62,
                            6.179282254262829234236001831817607754107275346429607936000000000E+63,
                            4.5589503739486047652209978556154966408304930303640526340380859375E+64,
                            5.31418273866603314144296157536314266853225679792946282496000000000E+65,
                            3.966286825335286145742268134385482077522528936416725791613134765625E+66,
                            4.6764808100261091644698061863195655483083859821779272859648000000000E+67,
                            3.52999527454840466971061863960307904899505075341088595453568994140625E+68,
                            4.208832729023498248022825567687608993477547383960134557368320000000000E+69,
                            3.2122956998390482494366629620388019345854961856039062186274778466796875E+70,
                            3.87212611070161838818099952227260027399934359324332379277885440000000000E+71,
                            2.987435000850314871976096554696085799164511452611632783323554397412109375E+72,
                            3.6397985440595212848901395509362442575593829776487243652121231360000000000E+73,
                            2.83806325080779912837729172696128150920628587998105114415737667754150390625E+74,
                            3.494206602297140433494533968898794487257007658542775390603638210560000000000E+75,
                            2.7529213532835651545259729751524430639300973035816196098326553772152587890625E+76,
                            3.42432247025119762482464328952081859751186750537191988279156544634880000000000E+77,
                            2.725392139750729502980713245400918633290796330545803413734328823443106201171875E+78,
                            3.4243224702511976248246432895208185975118675053719198827915654463488000000000000E+79,
                            2.75264606114823679801052037785492781962370429385126144787167211167753726318359375E+80,
                            3.492808919656221577321136155311234969462104855479358280447396755275776000000000000E+81,
                            2.8352254429826839019508359891905756542124154226667992913078222750278633810791015625E+82,
                            3.63252127644247044041398160152368436824058904969853261166529262548680704000000000000E+83,
                            2.976986715131818097048377788650104436923036193800139255873213388779256550133056640625E+84,
                            3.8504725530290186668388204976151054303350243926804445683652101830160154624000000000000E+85,
                            3.18537578519104536384176423385561174750764872736614900378433832599380450864237060546875E+86,
                            4.158510357271340160185926137424313864761826344094880133834426997657296699392000000000000E+87,
                            3.4720596058582394465875230149026168047833371128291024141249287753332469144201839599609375E+88,
                            4.57436139299847417620451875116674525123800897850436814721786969742302636933120000000000000E+89,
                            3.853986162502645785712150546541904653309504195240303679678670940619904075006404195556640625E+90,
                            5.1232847601582910773490610013067546813865700559248923248840140611137895336509440000000000000E+91,
                            4.35500436362798973785473011759235225823973974062154315803689816290049160475723674097900390625E+92,
                            5.840544626580451828177929541489700336780689863754377250367776029669720068362076160000000000000E+93,
                            5.0082550181721881985329396352312050969757007017147746317424328873355653454708222521258544921875E+94,
                            6.77503176683332412068639826812805239066560024195507761042662019441687527930000834560000000000000E+95,
                            5.859658371261460192283539373220509963461569821006286319138646478182611454200862034987249755859375E+96,
                            7.9945374848633224624099499563911018209854082855069915803034118294119128295740098478080000000000000E+97,
                            6.97299346180113762881741185413240685651926808699748071977498930903730763049902582163482720947265625E+98,
                            9.593444981835986954891939947669322185182489942608389896364094195294295395488811817369600000000000000E+99,
                            8.4373220887793765308690683435002122963883143852669516709277370639351422329038212441781409234619140625E+100,
                            1.170400287783990408496816673615657306592263772998223567356419491825904038249635041719091200000000000000E+102,
                            1.0377906169198633132968954062505261124557626693878350555241116588640224946471700130339113335858154296875E+103,
                            1.45129635685214810653605267528341506017440707851779722352196016986412100742954745173167308800000000000000E+104,
                            1.297238271149829141621119257813157640569703336734793819405139573580028118308962516292389166982269287109375E+105,
                            1.8286334096337066142354263708571029758197529189324245016376698140287924693612297891819080908800000000000000E+106,
                            1.64749260436028300985882145742271020352352323765318815064452725844663571025238239569133424206748199462890625E+107,
                            2.340650764331144466221345754697091809049283736233503362096217361956854360782374130152842356326400000000000000E+108,
                            2.1252654596247650827178796800752961625453449765726127143314401633961600662255732904418211722670517730712890625E+109,
                            3.04284599363048780608774948110621935176406885710355437072508257054391066901708636919869506322432000000000000000E+110,
                            2.784097752108442258360422380898637972934401919310122655774186614048969686755501010478785735669837822723388671875E+111,
                            4.0165567115922439040358293150602095443285708913766917693571089931179620831025540073422774834561024000000000000000E+112,
                            3.70285001030422820361936176659518850400275455268246313217966819668512968338481634393678502844088430422210693359375E+113,
                            5.382185993533606831408011282180680789400284994444766970938526050778069191357422369838651827831177216000000000000000E+114,
                            4.9988475139107080748861383849035044804037186461213252284425520655249250725695020643146597883951938106998443603515625E+115,
                            7.31977295120570529071489534376572587358438759244488308047639542905817410024609442298056648585040101376000000000000000E+116,
                            6.848421094057670062594009587317801138153094545186215562966296329769147349420217828111083910101415520658786773681640625E+117,
                            1.01012866726638733011865555743967017055464548775739386510574256921002802583396103037131817504735533989888000000000000000E+119,
                            9.51930532074016138700567332637174358203280141780883963252315189837911481569410278107440663504096757371571361541748046875E+119,
                            1.4141801341729422621661177804155382387765036828603514111480395968940392361675454425198454450662974758584320000000000000000E+121,
                            1.34222205022436275556779993901841584506662499991104638818576441767145518901286849213149133554077642789391561977386474609375E+122,
                            2.008135790525578012275887248190064299062635229661699003830216227589535715357914528378180531994142415718973440000000000000000E+123,
                            1.9193775318208387404619539127963346584452737498727963351056431172701809202884019437480326098233102918882993362766265869140625E+124,
                            2.89171553835683233767727763739369259065019473071284656551551136772893143011539692086457996607156507863532175360000000000000000E+125,
                            2.783097421140216173669833173554685254745646937315554685903182520041762334418182818434647284243799923238034037601108551025390625E+126,
                            4.2219046860009752130088253505947911823492843068407559856526465968842398879684795044622867504644850148075697602560000000000000000E+127,
                            4.09115320907611777529465476512538732447610099785386538827767830446139063159472874309893150783838588715991003527362957000732421875E+128,
                            6.248418935281443315253061518880290949876940774124318858765916963388675034193349666604184390687437821915203245178880000000000000000E+129,
                            6.0958182815234154851890356000368271134693904868022594285337406736474720410761458272174079466791949718682659525577080593109130859375E+130,
                            9.37262840292216497287959227832043642481541116118647828814887544508301255129002449990627658603115673287280486776832000000000000000000E+131,
                            9.204685605100357382635443756055608941338779635071411737085948417207682782024980199098285999485584407521081588362139169559478759765625E+132,
                            1.42463951724416907587769802630470633657194249650034469979862906765261790779608372398575404107673582339666633990078464000000000000000000E+134,
                            1.408316897580354679543222894676508168024833284165925995774150107832775465649821970462037757921294414350725483019407292942600250244140625E+135,
                            2.1939448565560203768516549605092477583207914446105308376898887641850315780059689349380612232581731680308661634472083456000000000000000000E+136,
                            2.18289119124954975329199548674858766043849159045718529344993266714080197175722405421615852477800634224362449868008130406103038787841796875E+137,
                            3.422553976227391787888581738394426502980434653592428106796226472128649261689311538503375508282750142128151214977645019136000000000000000000E+138,
                            3.4271391702617931126684329141952826268884317970177809107163942874110590956588417651193688839014699573224904629277276473758177089691162109375E+139,
                            5.40763528243927902486395914666319387470908675267603640873803782596326583346911223083533330308674522456247891966467913023488000000000000000000E+140,
                            5.449151280716251049142808333570499376752606557258271648039066916983583962097558406539796525403337232142759836055086959327550157260894775390625E+141,
                            8.6522164519028464397823346346611101995345388042816582539808605215412253335505795693365332849387923592999662714634866083758080000000000000000000E+142,
                            8.77313356195316418911992141704850399657169655718581735334289773634357017897706903452907240589937294374984333604869000451735575319004058837890625E+143,
                            1.4016590652082611232447382108150998523245952862936286371448994044896785040351938902325183921600843622065945359770848305568808960000000000000000000E+145,
                            1.43002077059836576282654719097890615144118653882128822859489233102400193917326225262823880216159778983122446377593647073632898776997661590576171875E+146,
                            2.298720866941548242121370665736763757812336269521550964917635023363072746617717979981330163142538354018815039002419122113284669440000000000000000000E+147,
                            2.3595342714873035086638028651151951498779577890551255771815723461896031996358827168365940235666363532215203652302951767149428298204614162445068359375E+148,
                            3.81587663912297008192147530512302783796847820740577460176327413878270075938541184676900807081661366767123296474401574270805255127040000000000000000000E+149,
                            3.940422233383796859468550784742375900296189507722059713893225818136637343391924137117112019356282709879939009934592945113954525800170565128326416015625E+150,
                            6.4106727537265897376280785126066867677870433884417013309623005531549372757674919025719335589719109616876713807699464477495282861342720000000000000000000E+151,
                            6.65931357441861669250185082621461527150056026805028091647955163265091711033235179172791931271211777969709692678946207724258314860228825506687164306640625E+152,
                            1.0898143681335202553967733471431367505237973760350892262635910940363393368804736234372287050252248634869041347308908961174198086428262400000000000000000000E+154,
                            1.13874262122558345441781649128269921142659580583659803671800332918330682586683215638547420247377214032820357448099801520848171841099129161643505096435546875E+155,
                            1.874480713189654839282450157086195210900931486780353469173376681742503659434414632312033372643386765197475111737132341321962070865661132800000000000000000000E+156,
                            1.9700247347202593761428225299190696357680107440973146035221457594871208087496196305468703702796258027677921838521265663106733728510149344964326381683349609375E+157,
                            3.26159644094999942035146327332997966696762078699781503636167542623195636741588146022293806839949297144360669442261027390021400330625037107200000000000000000000E+158,
                            3.447543285760453908249939427358371862594018802170300556163755079102461415311834353457023147989345154843636321741221491043678402489276135368757116794586181640625E+159,
                            5.7404097360719989798185753610607642138630125851161544639965487501682432066519513699923710003831076297407477821837940820643766458190006530867200000000000000000000E+160,
                            6.10215161579600341760239278642431819679141327984143198440984649001135670510194680561893097194114092407323628948196203914731077240601875960270009672641754150390625E+161,
                            1.0217929330208158184077064142688160300676162401506754945913856775299472907840473438586420380681931580938531052287153466074590429557821162494361600000000000000000000E+163,
                            1.09228513922748461175082830876995295722566297709161632520936252171203285021324847820578864397746422540910929581727120500736862826067735796888331731402873992919921875E+164,
                            1.839227279437468473133871545683868854121709232271215890264494219553905123411285218945555668522747684568935589411687623893426277320407809248985088000000000000000000000E+165,
                            1.9770361020017471472689992388736148525784499885358255486289461642987794588859797455524774455992102479904878254292608810633372171518260179236788043383920192718505859375E+166,
                            3.34739364857619262110364621314464131450151080273361292028137947958810732460853909848091131671140078591546277272927147548603582472314221283315286016000000000000000000000E+167,
                            3.617976066663197279502268607138715180218563479020560753990971480666766409761342934361033725446554753822592720535547412345907107387841612800332211939257395267486572265625E+168,
                            6.1592043133801944228307090321861400186827798770298477733177382424421174772797119412048768227489774460844515018218595148943059174905816716130012626944000000000000000000000E+169,
                            6.69325572332691496707919692320662308340434243618803739488329723923351785805848442856791239207612629457179653299076271283992814866750698368061459208762618124485015869140625E+170,
                            1.1456120022887161626465118799866220434749970571275516858370993130942338507740264210641070890313098049717079793388658697703409006532481909200182348611584000000000000000000000E+172,
                            1.25163882026213309884380982463963851659661203556716299284317658373666783945693658814219961731823561708492595166927262730106656380082380594827492872038609589278697967529296875E+173,
                            2.153750564302786385775442334374849441732994467399797169373746708617159639455169671600521327378862433346811001157067835168240893228106598929634281538977792000000000000000000000E+174,
                            2.3655973702954315568148005685689167963675967472219380564736037432623022165736101515887572767314653162905100486549252655990158055835569932422396152815297212373673915863037109375E+175,
                            4.09212607217529413297334043531221393929268948805961462181011874637260331496482237604099052201983862335894090219842888681965769713340253796630513492405780480000000000000000000000E+176,
                            4.518290977264274273516269085966631081062109787193901687864583149630997233655595389534526398557098754114874192930907257294120188664593857092677665187721767563371717929840087890625E+177,
                            7.8568820585765647353088136357994507634419638170744600738754279930353983647324589619987018022780901568491665322209834626937427784961328728953058590541909852160000000000000000000000E+178,
                            8.72030158612004934788639933591559798644987188928423025757864547878782466095529910180163594921520059544170719235665100657765196412266614418886789381230301139730741560459136962890625E+179,
                            1.5242351193638535586499098453450934481077409805124452543318330306488672827580970386277481496419494904287383072508707917625860990282497773416893366565130511319040000000000000000000000E+181,
                            1.70045880929340962283784787050354160735772501841042490022783586836362580888628332485131901009696411611113290250954694628264213300391989811682923929339908722247494604289531707763671875E+182,
                            2.987500833953152974953823296876383158291172321804392698490392740071779874205870195710386373298221001240327082211706751854668754095369563589711099846765580218531840000000000000000000000E+183,
                            3.3499038543080169569905603048919769664947182862685370534488366606763428435059781499570984498910193087389318179438074841768050020177221992901536014079962018282756437045037746429443359375E+184,
                            5.91525165122724289040857012781523865341652119717269754301097762534212415092762298750656501913047758245584762277917936867224413310883173590762797769659584883269304320000000000000000000000E+185,
                            6.666308670072953744411215006735034163324489389674388736363184954745922258576896518414625915283128424390474317708176893511841954015267176587405666801912441638268530971962511539459228515625E+186,
                            1.18305033024544857808171402556304773068330423943453950860219552506842483018552459750131300382609551649116952455583587373444882662176634718152559553931916976653860864000000000000000000000000E+188,
                            1.339928042684663702626654216353741866828222367324552136009000175903930373973956200201339808971908813302485337859343555595880232757068702494068539027184400769291974725364464819431304931640625E+189,
                            2.3897616670958061277250623316373564159802745636577698073764349606382181569747596869526522677287129433121624396027884649435866297759680213066817029894247229284079894528000000000000000000000000E+190,
                            2.72005392664986731633210805919809598966129140566884083609827035708497865916713108640871981221297489100404523585446741785963687249684946606295913422518433356166270869248986358344554901123046875E+191,
                            4.875113800875444500559127156540207088599760109861850407047927319701965040228509761383410626166574404356811376789688468484916724742974763465630674098426434773952298483712000000000000000000000000E+192,
                            5.5761105496322279984808215213560967788056473816211237140014542320242062512926187271378756150365985265582927335016582066122555886185414054290662251616278838014085528196042203460633754730224609375E+193,
                            1.004273442980341567115180194247282660251550582631541183851873027858604798287073010844982588990314327297503143618675824507892845297052801273919918864275845563434173487644672000000000000000000000000E+195,
                            1.1542548837738711956855300549207120332127690079955726087983010260290106940175720765175402523125758949975665958348432487687369068440380709238167086084569719468915704336580736116351187229156494140625E+196,
                            2.08888876139911045959957480403434793332322521187360566241189589794589798043711186255756378509985380077880653872684571497641711821786982664975343123769375877194308085430091776000000000000000000000000E+197,
                            2.412392707087390798982757814784288149414687226710746752388449144400632350496725639921659127333283620544914185294822389926660135304039568230776920991675071369003382206345373848317398130893707275390625E+198,
                            4.3866663989381319651591070884721306599787729449345718910649813856863857589179349113708839487096929816354937313263760014504759482575266359644822055991568934210804697940319272960000000000000000000000000E+199,
                            5.09014861195439458585361898919484799526499004835967564753962769468533425954809110023470075867322843934976893097207524274525288549152348896693930329243440058859713645538873881994971005618572235107421875E+200,
                            9.299732765748839766137307027560916999154998643261292409057760537655137808906022012106273971264549121067246710411917123075009010305956468244702275870212614052690595963347685867520000000000000000000000000E+201,
                            1.08420165434628604678682084469850262299144288030061091292594069896797619728374340434999126159739765758150078229705202670473886460969450314995807160128852732537119006499780136864928824196755886077880859375E+203,
                            1.990142811870251709953383703898036237819169709657916575538360755058199491105888710590742629850613511908390796028150264338051928205474684204366287036225499407275787536156404775649280000000000000000000000000E+204,
                            2.3310335568445150005916648161017806394316021926463134627907725027811488241600483193524812124344049638002266819386618574151885589108431817724098539427703337495480586397452729425959697202302515506744384765625E+205,
                            4.29870847363974369349930880041975827368940657286109980316285923092571090078871961487600408047732518572212411942080457097019216492382531788143117999824707871971570107809783431540244480000000000000000000000000E+206,
                            5.058342818352597551283912650940863987566576758042500214255976331035092948427304852994884230982658771446491899806896230590959172836529704446129383055811624236519287248247242285433254292899645864963531494140625E+207,
                            9.3711844725346412518284931849150730366429063288371975708950331234180497637194087604296888954405689048742305803373539647150189195339391929815199723961786316089802283502532788075773296640000000000000000000000000E+208,
                            1.107777077219218863731176870556049213277080310011307546922058816496685355705579762805879646585202270946781726057710274499420058851200005273702334889222745707797723907366146060509882690145022444427013397216796875E+210,
                            2.0616605839576210754022685006813160680614393923441834655969072871519709480182699272945315569969251590723307276742178722373041622974666224559343939271592989539756502370557213376670125260800000000000000000000000000E+211,
                            2.44818734065447368884590088392886876134234748512498967869774998445767463610933127580099401895329701879238761458753970664371833006115201165488216010518226801423296983527918279372684074522049960218369960784912109375E+212,
                            4.576886496385918787393036071512521671096395451004087293625134177477375504600559238593860056533173853140574215436763676366815240300375901852174354518293643677825943526263701369620767807897600000000000000000000000000E+213,
                            5.4594577696594763261263589711613773377934348918287269834959824653406144385238087450362166622658523519070243805302135458154918760363689859903872170345564576717395227326725776300108548618417141128696501255035400390625E+214,
                            1.025222575190445808376040080018804854325592581024915553772030055754932113030525269445024652663430943103488624257835063506166613827284202014887055412097776183833011349883069106795051988969062400000000000000000000000000E+216,
                            1.2283779981733821733784307685113099010035228506614635712865960547016382486678569676331487490098167791790804856192980478084856721081830218478371238327752029761413926148513299667524423439143856753956712782382965087890625E+217,
                            2.31700301993040752692985058084249897077583923311630915152478792600614657544898710894575571501935393141388429082270724352393654724966229655364474523134097417546260565073573618135681749507008102400000000000000000000000000E+218,
                            2.788418055853577533569037844520673475277996871001522306820573044172718824476035316527247660252284088736512702355806568525262475685575459594590271100399710755840961235712519024528044120685655483148173801600933074951171875E+219,
                            5.2827668854413291614000593243208976533689134515051848654765164712940141920236906083963230302441269636236561830757725152345753277292300361423100191274574211200547408836774784934935438887597847347200000000000000000000000000E+220,
                            6.38547734790469255187309666395234225838661283459348608261911227115552610805012087484739714197773056320661408839479704192285106931996780247161172081991533763087580122978166856616922103637015105640931800566613674163818359375E+221,
                            1.2150363836515057071220136445938064602748500938461925190595987883976232641654488399311542969561492016334409221074276785039523253777229083127313043993152068576125904032458200535035150944147504889856000000000000000000000000000E+223,
                            1.47504526736598397948268532937299106168730756479109528508501493463692653095957792208974873979685576010072785441919811668417859701291256237094230750940044299273231008407956543878509005940150489403055245930887758731842041015625E+224,
                            2.818884410071493240523071655457630987837652217723166644218269189082485972863841308640277968938266147789582939289232214129169394876317147285536626206411279909661209735530302524128155019042221134446592000000000000000000000000000E+225,
                            3.4368554729627426721946568174390691737314266259632520142480847977040388171358165584691145637266739210346959007967316118741361310400862703242955764969030321730662824959053874723692598384055064030911872301896847784519195556640625E+226,
                            6.59618951956729418282398767377085651154010618947220994747074990245301717650138866221825044731554278582762407793680338106225638401058212464815570532300239498860723078114090790645988274455879745460502528000000000000000000000000000E+227,
                            8.076610361462445279657443520981812558268852571013642233482999274604491220269168912402419224757683714431535366872319287904219907944202735262094604767722125606705763865377660560067760620252940047264289990945759229362010955810546875E+228,
                            1.55670072661788142714646109100992213672346506071544154760309697697891205365432772428350710556646809745531928239308559793069250662649738141696474645622856521731130646434925426592453232771587619928678596608000000000000000000000000000E+230,
                            1.914156655666599531278814114472689576309718059330233209335470828081264419203793032239373356267571040320273881948739671233300118182776048257116421329950143768789266036094505552736059266999946791201636727854144937358796596527099609375E+231,
                            3.7049477293505577966085773966036146854018468445027508832953708052098106876972999837947469112481940719436598920955437230750481657710637677723760965658239852172009093851512251529003869399637853543025505992704000000000000000000000000000E+232,
                            4.57483440704317287975636573358972808738022616179925737031177527911422196189706534705210232147949478636545457785748781424758728245683475533450824697858084360740634582626586827103918164812987283097191177957140640028752386569976806640625E+233,
                            8.891874550441338711860585751848675244964432426806602119908889932503545650473519961107392586995665772664783741029304935380115597850553042653702631757977564521282182524362940366960928655913084850326121438248960000000000000000000000000000E+234,
                            1.10253509209740466402128414179512446905863450499362102624513784226652749281719274863955665947655824351407455326365456323366853507209717603561648752183798330938492934413007425332044277719929935226423073887670894246929325163364410400390625E+236,
                            2.151833641206803968270261751947379409281392647287197713017951363665858047414591830587989006052951116984877665329091794361987974679833836322196036885430570614150288170895831568804544734730966533778921388056248320000000000000000000000000000E+237,
                            2.6791602737966933335717204645621524598124818471344990937756849567076618075457783791941226825280365317392011644306805886578145402251961377665480646780662994418053783062360804355686759485942974260020806954704027302003826014697551727294921875E+238,
                            5.25047408454460168257943867475160575864659805938076241976380132734469363569160406663469317476920072544310150340298397824325065821879456062615833000045059229852670313698582902788308915274355834242056818685724590080000000000000000000000000000E+239,
                            6.563942670801898667250715138177273526540580525479522779750428143933771428487157029025600572193689502761042852855167442211645623551730537528042758461262433632423176850278397067143256074056028693705097703902486688990937373600900173187255859375E+240,
                            1.29161662479797201391454191398889501662706312260766755526189512652679463438013460039213452099322337845900296983713405864783966192182346191403494918011084570543756897169851394085923993157491535223545977396688249159680000000000000000000000000000E+242,
                            1.621293839688068970810926639129786561055523389793442126598355751551641542836327786169323341331841307181977584655226358226276469017277442769426561339931821107208524682018764075584384250291839087345159132863914212180761531279422342777252197265625E+243,
                            3.2032092294989705945080639466924596412351165440670155370494999137864506932627338089724936120631939785783273651960924654466423615661221855468066739666748973494851710498123145733309150303057900735439402394378685791600640000000000000000000000000000E+244,
                            4.03702166082329173731920733143316853702825324058567089522990582136358744166245618756161511991628485488312418579151363198342840785302083249587213773643023455694922645822672254820511678322667932748944624083114638833009621288576163351535797119140625E+245,
                            8.008023073747426486270159866731149103087791360167538842623749784466126733156834522431234030157984946445818412990231163616605903915305463867016684916687243373712927624530786433327287575764475183859850598594671447900160000000000000000000000000000000E+246,
                            1.01329243686664622606712104018972530279409156338700339470270636116226044785727650307796539509898749857566417063366992162784053037110822895646390657184398887379425584101490735959948431258989651119985100644861774347085414943432617001235485076904296875E+248,
                            2.018021814584351474540080286416249573978123422762219788341184945685463936755522299652670975599812206504346240073538253231384687786656976894488204599005185330175657761381758181198476469092647746332682350845857204870840320000000000000000000000000000000E+249,
                            2.5636298652726149519498162316800050160690516553691185885978470937405189330789095527872524496004383713964303517031849017184365418389038192598536836267652918506994672777677156197866953108524381733356230463150028909812609980688452101312577724456787109375E+250,
                            5.12577540904425274533180392749727391790443349381603826238660976204107839935902664111778427802352300452103944978678716320771710697810872131200003968147317073864617071390966578024413023149532527568501317114847730037193441280000000000000000000000000000000E+251,
                            6.537256156445168127472031390784012790976081721191252400924510089038323279351219359607493746481117847060897396843121499382013181689204739112626893248251494219283641558307674830456073042673717342005838768103257372002215545075555285834707319736480712890625E+252,
                            1.31219850471532870280494180543930212298353497441690579517097209908251607023591082012615277517402188915738609914541751378117557938639583265587201015845713170909341970276087443974249733926280327057536337181401018889521520967680000000000000000000000000000000E+254,
                            1.680074832206408208760312067431491287280853002346151867037599092882849082793263375419125892845647286694650630988682225341177387694125617951945111564800634014355895880485072431427210771967145356895500563402537144604569395084417708459519781172275543212890625E+255,
                            3.3854721421655480532367498580333994772975202339956169515411080156328914612086499159254741599489764740260561357951771855554329948169012482521497862088193998094610228331230560545356431352980324380844374992801462873496552409661440000000000000000000000000000000E+256,
                            4.35139381541459726068920825464756243405740927607653333562738165056657912443455214233553606247022647253914513426068696363364943412778535049553783895283364209718177033045633759739647589939490647435934645921257120452583473326864186491015623323619365692138671875E+257,
                            8.802227569630424938415549630886838640973552608388604074006880840645517799142489781406232815867338832467745953067460682444125786523943245455589444142930439504598659366119945741792672151774884339019537498128380347109103626511974400000000000000000000000000000000E+258,
                            1.13571378582320988503988335446301379528898382105597520059874661079787715147741810914957491230472910933271688004203929750838250230735197647933537596668958058736444205624910411292048020974207058980778942585448108438124286538311552674155077687464654445648193359375E+260,
                            2.306183623243171333864874003292351723935070783397814267389802780249125663375332322728432997757242774106549439703674698800360956069273130309364434365447775150204848753923425784349680103765019696823118824509635650942585150146137292800000000000000000000000000000000E+261,
                            2.9869272567150419976548932222377262816100274493772147775747035863984169083856096270633820193614375575450453945105633524470459810683356981406520387923935969447684826079351438169808629516216456511944861899972852519226687359575938353302785431803204119205474853515625E+262,
                            6.08832476536197232140326736869180855118858686817022966590907933985769175131087733200306311407912092364129052081770120483295292402288106401672210672478212639654080071035784407068315547393965199961303369670543811848842479638580245299200000000000000000000000000000000E+263,
                            7.915357230294861293785467038929974646266572740849619160572964503955804807221865511717962351307809527494370295452992883984671849831089600072727902799843031903636478911028131114999286821797360975665388403492805917595072150287623663625238139427849091589450836181640625E+264,
                            1.61949438758628463749326912007202107461616410693328109113181510440214600584869337031281478834504616568858327853750852048556547779008636302844808038879204562147985298895518652280171935606794743189706696332364653951792099583862345249587200000000000000000000000000000000E+266,
                            2.113400380488727965440719699394303230553174921806848315872981522556199883528238091628695947799185143840996868885949100023907383904900923219418350047558089518270939869244511007704809581419895380502658703732579179997884264126795518187938583227235707454383373260498046875E+267,
                            4.3402449587312428284819612417930164799713198065811933242332644797977512956744982324383436327647237240454031864805228349013154804774314529162408554419626822655660060103998998811086078742620991174841394617073727259080282688475108526889369600000000000000000000000000000000E+268,
                            5.68504702351467822703553599137067569018804053966042196969832029567617768669096046648119209957980803693228157730320307906431086270418348346023536162793126080414882824826773461072593777401951857355215191304063799419430867050107994392555478888126405305229127407073974609375E+269,
                            1.1718661388574355636901295352841144495922563477769221975429814095453928498321145227583527808464754054922588603497411654233551797289064922873850309693299242117028216228079729678993241260507667617207176546609906359951676325888279302260129792000000000000000000000000000000000E+271,
                            1.54064774337247779952663025366145311204095898624797435378824480012824415309325028641640305898612797800864830744916803442642824379283372401772378300116937167792433245528055607950672913675928953343263316843401289642665764970579266480382534778682255837717093527317047119140625E+272,
                            3.187475897692224733237152335972791302890937265953228377316909433963468551543351501902719563902413102938944100151295969951526088862625659021687284236577393855831674814037686472686161622858085591880352020677894529906855960641611970214755303424000000000000000000000000000000000E+273,
                            4.2059683394068643927077005924957669958718180324569699858419083043501065379445732819167803510321293799636098793362287339841491055544360665683859275931923846807334276029159180970533705433528604262710885498248552072447753836968139749144431994580255843696766532957553863525390625E+274,
                            8.73368395967669576906979740056544816992116810871184575384833184905990383122878311521345160509261190205270683441455095766718148348359430571942315880822205916497878899046326093516008284663115452175216453665743101194478533215801679838842953138176000000000000000000000000000000000E+275,
                            1.1566412933368877079946176629363359238647499589256667461065247836962792979347576525271145965338355794899927168174629018456410040274699183063061300881279057872016925908018774766896768994220366172245493512018351819923132305166238431014718798509570357016610796563327312469482421875E+277,
                            2.41049677287076803226326408255606369489824239800446942806213959034053345741914413979891264300556088496654708629841606431614208944147202837856079183106928832953414576136786001810418286567019864800359741211745095929676075167561263635520655066136576000000000000000000000000000000000E+278,
                            3.203896382543178951145090926333650509105357386224096886715073650838693655279278697500107432398724555187279825584372238112425581156091673708467980344114299030548688476521200610430405011399041429712001702829083454118707648531048045391077107187150988893601190648041665554046630859375E+279,
                            6.7011810285807351296918741495058570718171138664524250100127480611466830116252207086409771475554592602070008999095966587988750086472922388923990012903726215561049252166026508503296283665631522414500008056865136668449948896582031290674742108385968128000000000000000000000000000000000E+280,
                            8.93887090729546927369480368447088492040394710756523031393505548583995529822918756602529973639244150897251071338039854433366737142549576964662566516007889429523084084949414970310082998180332558889648475089314283699119433940162404664110512905215125901314732190803624689579010009765625E+281,
                            1.8763306880026058363137247618616399801087918826066790028035694571210712432550617984194736013155285928579602519746870644636850024212418268898717203613043340357093790606487422380922959426376826276060002255922238267165985691042968761388927790348071075840000000000000000000000000000000000E+283,
                            2.51182272495002686590823983533631866263350913722582971821575059152102743880240170605310922592627606402127551045989199095776053137056431127070181190998216929695986627870785606657133322488673449047991221500097313719452560937185635710615054126365450378269439745615818537771701812744140625E+284,
                            5.291252540167348458404703828449824743906793108950834787906065869081420905979274271542915555709790631859447910568617521787591706827901951829438251418878221980700448951029453111420274558238265009848920636170071191340807964874117190711677636878156043386880000000000000000000000000000000000E+285,
                            7.1084583116085760305203187340017818152528308583490981025505741740045076518107968281302991093713612611802096946014943344104623037786970008960861277052495391103964215687432326683968730264294586080581515684527539782605074745223534906104060317761422457050251448009276646189391613006591796875E+286,
                            1.502715721407526962186935887279750227269529242942037079765322706819123537298113893118188017821580539448083206601487376187676044739124154319560463402961415042518927502092364683643357974539667262797093460672300218340789462024249282162116448873396316321873920000000000000000000000000000000000E+288,
                            2.0259106188084441686982908391905078173470567946294929592269136395912846807660770960171352461708379594363597629614258853069817565769286452553845463959961186464629801470918213104931088125323957032965731970090348838042446302388707448239657190562005400259321662682643844163976609706878662109375E+289,
                            4.29776696322552711185463663762008564999085363481422604812882294150269331667260573431801773096972034282151797088025389589675348795389508135394292533246964702160413265598416299522000380718344837159968729752277862445465786138935294698365304377791346468055941120000000000000000000000000000000000E+290,
                            5.814363475980234764164094708476757435786053000586644792981242145626987033798641265569178156510304943582352519699292290831037641375785211882953648156508860515348753022153527161115222291967975668461165075415930116518182088785559037644781613691295549874425317189918783275061286985874176025390625E+291,
                            1.23775688540895180821413535163458466719736584682649710186110100715277567520171045148358910651927945873259717561351312201826500453072178342993556249575125834222199020492343894262336109646883313102070994168656024384294146408013364873129207660803907782800111042560000000000000000000000000000000000E+293,
                            1.680351044558287846843423370749782898942169317169540345171578980086199252767807325749492487231478128695299878193095472050169878357601926234173604317231060688935789623402369349562299242378744968185276706795203803673754623659026561879341886356784413913708916667886528366492711938917636871337890625E+294,
                            3.5894949676859602438209925197402955348723609557968415953971929207430494580849603093024084089059104303245318092791880538529685131390931719468131312376786491924437715942779729336077471797596160799600588308910247071445302458323875813207470221633133257012032202342400000000000000000000000000000000000E+295,
                            4.88982153966461763431436200888186823592171271296336240444929483205083982555431931793102313784360135450332264554190782366599434602062160534144518856314238660480314780410089480722629079532214785741915521677404306869062595484776729506888488929824264448889294750354979754649379174225032329559326171875E+296,
                            1.0481325305643003911957298157641662961827293990926777458559803328569704417608084103163032554005258456547632883095229117250668058366152062084694343214021655641935813055291680966134621764898078953483371786201792144862028317830571737456581304716874911047513403083980800000000000000000000000000000000000E+298,
                            1.43271771112173296685410806860238739312506182489826518450364338579089606888741556015378977938817519686947353514377899233413634338404213036504344024900071927520732230660156217851730320302938932222381247851479461912635340477039581745518327256438509483524563361854009068112268098047934472560882568359375E+299,
                            3.081509639859043150115445658346648910777224433332472572816582178599493098776776726329931570877545986225004067629997360471696409159648706252900136904922366758729129038255754204043578798880035212324111305143326890589436325442188090812234903586761223847968940506690355200000000000000000000000000000000000E+300,
                            4.2265172478091122522196188023770428097189323834498822942857479880831434032178759024536798491951168307649469286741480273857022129829242845768781487345521218618616008044746084266260444489366985005602468116186441264227425440726676614927906540649360297639746191746932675093119088924140669405460357666015625E+301,
                            9.12126853398276772434171914870608077590058432266411881553708324865449957237925910993659744979753611922601204018479218699622137111256017050858440523857020560583822195323703244396899324468490422847936946322424759614473152330887674880421531461681322258998806389980345139200000000000000000000000000000000000E+302,
                            1.2552756225993063389092267843059817144865229178846150414028671524606935907557091430287429152109496987371892378162219641335535572559285125193328101741619801929728954389289587027079352013341994546663933030507373055475545355895822954633588242572860008399004618948839004502656369410469778813421726226806640625E+304,
                            2.71813802312686478185383230631441207121837412815390740703005080809904087256901921476110604003966576352935158797506807172487396859154293081155815276109392127053979014206463566830275998691610146008685210004082578365112999394604527114365616375581034033181644304214142851481600000000000000000000000000000000000E+305,
                            3.753274111571925953338588085074885326314703524474998973794572785857473836359570337655941316480739599224195821070503672759325136195226252432805102420744320776988957362397586521096726251989256369452515976121704543587188061412851063435442884529285142511302381065702862346294254453730463865213096141815185546875E+306,
                            8.1544140693805943455614969189432362136551223844617222210901524242971226177070576442833181201189972905880547639252042151746219057746287924346744582832817638116193704261939070049082799607483043802605563001224773509533899818381358134309684912674310209954493291264242855444480000000000000000000000000000000000000E+307,
                          };
        #endregion

        #region public constructors

        /// <summary>Initializes a new instance of the <see cref="DoubleFactorial" /> class.
        /// </summary>
        public DoubleFactorial()
        {
        }
        #endregion

        #region public properties

        /// <summary>Gets the value of n!! with 0!! = 1.
        /// </summary>
        /// <param name="n">The value of the parameter 'n'.</param>
        /// <value>The value of n!! with 0!! = 1.</value>
        public double this[int n]
        {
            get { return GetValue(n); }
        }
        #endregion

        #region public methods

        /// <summary>Gets the value of n!! with 0!! = 1.
        /// </summary>
        /// <param name="n">The value of the parameter 'n'.</param>
        /// <returns>The value of n!! with 0! = 1.</returns>
        public double GetValue(int n)
        {
            if (n < 0)
            {
                throw new ArgumentOutOfRangeException(nameof(n), String.Format(ExceptionMessages.ArgumentOutOfRangeGreaterEqual, "n", 0));
            }
            if (n < m_Values.Length)
            {
                return m_Values[n];
            }
            else
            {
                throw new NotFiniteNumberException();
            }
        }

        /// <summary>Gets the value of n!! with 0!! = 1.
        /// </summary>
        /// <param name="n">The value of the parameter 'n'.</param>
        /// <returns>The value of n!! with 0! = 1.</returns>
        public BigInteger GetBigValue(long n)
        {
            if (n < 0)
            {
                throw new ArgumentOutOfRangeException(nameof(n), String.Format(ExceptionMessages.ArgumentOutOfRangeGreaterEqual, "n", 0));
            }
            else if (n == 0)
            {
                return BigInteger.One;
            }
            else if (n % 2 == 0)  // n is even
            {
                BigInteger value = 2;
                for (long j = 2; j <= n / 2; j++)
                {
                    value *= 2 * j;
                }
                return value;
            }
            else
            {
                BigInteger value = 1;
                for (long j = 2; j <= (n + 1) / 2; j++)
                {
                    value *= 2 * j - 1;
                }
                return value;
            }
        }
        #endregion
    }
}